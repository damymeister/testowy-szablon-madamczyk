___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "help": {
    "messageId": "TAG_HELP",
    "description": "Tag help.",
    "text": "Tag help."
  },
  "displayName": "testowy-madamczyk2",
  "description": "test2",
  "categories": [
    "REMARKETING",
    "PERSONALIZATION",
    "ADVERTISING"
  ],
  "securityGroups": [
    "NON_GOOGLE_SCRIPTS"
  ],
  "id": "cvt_5M33C",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/png;base64,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\u003d\u003d",
    "displayName": "test-madamczyk",
    "id": "github.com_damymeister"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "help": {
      "messageId": "TAGGING_HASH_HELP",
      "description": "Tagging hash field hint help.",
      "text": "In this field you should insert the static client tagging hash identifier which you can receive from your Customer Service Manager."
    },
    "valueValidators": [
      {
        "args": [
          20,
          20
        ],
        "type": "STRING_LENGTH"
      },
      {
        "args": [
          "^[a-zA-Z0-9]{20}$"
        ],
        "type": "REGEX"
      }
    ],
    "displayName": {
      "messageId": "TAGGING_HASH_NAME",
      "description": "Tagging hash field.",
      "text": "Tagging hash"
    },
    "name": "advTaggingHash",
    "type": "TEXT",
    "valueHint": {
      "messageId": "TAGGING_HASH_HINT",
      "description": "Tagging hash field hint.",
      "text": "20 characters long tagging hash."
    }
  },
  {
    "help": {
      "messageId": "REGION_HELP",
      "description": "Region hash field help.",
      "text": "Please select your region. If you are not sure, contact your RTB House Customer Service Manager."
    },
    "selectItems": [
      {
        "displayValue": "EMEA",
        "value": "ams"
      },
      {
        "displayValue": "Americas",
        "value": "us"
      },
      {
        "displayValue": "Asia",
        "value": "asia"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "advTaggingHash",
        "type": "PRESENT",
        "paramValue": ""
      }
    ],
    "displayName": {
      "messageId": "REGION_NAME",
      "description": "Region field.",
      "text": "Region"
    },
    "name": "advRegion",
    "type": "SELECT"
  },
  {
    "type": "GROUP",
    "name": "tagGroup",
    "displayName": "Select tag type(s)",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "tagHome",
        "checkboxText": "Home page view",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "tagOffer",
        "checkboxText": "Product page view",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "offerOfferId",
            "displayName": "Variable containing the id of the currently viewed product",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOffer",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains product ID."
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagWishlist",
        "checkboxText": "Wishlist page view",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "wishlistOfferId",
            "displayName": "Variable containing the id of the currently viewed product",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagWishlist",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains product ID."
          }
        ],
        "help": "The code should be pasted into pages displaying products which the user added to the wish list or favorites list.",
        "valueValidators": []
      },
      {
        "type": "CHECKBOX",
        "name": "tagCategory",
        "checkboxText": "Category page view",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "category",
            "displayName": "Category name or ID",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Select variable that contains category name or ID.",
            "enablingConditions": [
              {
                "paramName": "tagCategory",
                "paramValue": true,
                "type": "EQUALS"
              }
            ]
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagListing",
        "checkboxText": "Search result page view",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "listingOfferIds",
            "displayName": "Products IDs",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Select variable that contains string with comma separated products IDs or array with products IDs. Example: \u0027123,456,789\u0027 or [\u0027123\u0027, \u0027456\u0027, \u0027789\u0027]",
            "enablingConditions": [
              {
                "paramName": "tagListing",
                "paramValue": true,
                "type": "EQUALS"
              }
            ]
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagBasketAdd",
        "checkboxText": "Shopping cart - product added to cart event",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "basketAddOfferId",
            "displayName": "Product ID",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Select variable that contains a product ID as a string.",
            "enablingConditions": [
              {
                "paramName": "tagBasketAdd",
                "paramValue": true,
                "type": "EQUALS"
              }
            ]
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagBasketStatus",
        "checkboxText": "Shopping cart page view",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "basketStatusOfferIds",
            "displayName": "Products IDs",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagBasketStatus",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains string with comma separated IDs of products or array with products IDs that are currently in the shopping cart. Example: \u0027123,456,789\u0027 or [\u0027123\u0027, \u0027456\u0027, \u0027789\u0027]"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagStartOrder",
        "checkboxText": "Order process start event",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "tagOrderClick",
        "checkboxText": "Click action conversion event",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "TEXT",
            "name": "orderClickValue",
            "displayName": "Order Value",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOrderClick",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable or input text containing the value of the conversion. This value should only be formatted with the decimal point (dot or comma), without the thousands separator.",
            "valueHint": "100.0",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              },
              {
                "type": "REGEX",
                "args": [
                  "^[\\d\\.\\,]+$"
                ]
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "orderClickOrderId",
            "displayName": "Order identifier",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOrderClick",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable or input text that contains the internal conversion identifier.",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "orderClickOfferId",
            "displayName": "Products ID",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOrderClick",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable or input text that contains ID of the product, that has been clicked. Tag only for websites where lead or click is treated as a conversion (most offer aggregators, classifieds, click-through sites).",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagOrderStatus",
        "checkboxText": "Order confirmation page view",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "orderStatusValue",
            "displayName": "Order Value",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOrderStatus",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains value of the order. This value should only be formatted with the decimal point (dot or comma), without the thousands separator.",
            "valueValidators": []
          },
          {
            "type": "SELECT",
            "name": "orderStatusOrderId",
            "displayName": "Order identifier",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOrderStatus",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains the internal (shop) order identifier.",
            "valueValidators": []
          },
          {
            "type": "SELECT",
            "name": "orderStatusOfferIds",
            "displayName": "Products IDs",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagOrderStatus",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains string with comma separated IDs of products or array with products IDs that are currently in the shopping cart. Example: \u0027123,456,789\u0027 or [\u0027123\u0027, \u0027456\u0027, \u0027789\u0027]",
            "valueValidators": []
          },
          {
            "type": "CHECKBOX",
            "name": "orderStatusCustomDeduplicationCheck",
            "checkboxText": "Custom Deduplication",
            "simpleValueType": true,
            "help": "(Optional) Select variable that returns false when the order is attributed to RTB House, and true when the order is attributed to a source other than RTB House.",
            "enablingConditions": [
              {
                "paramName": "tagOrderStatus",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "subParams": [
              {
                "type": "SELECT",
                "name": "orderStatusCustomDeduplication",
                "displayName": "Select variable:",
                "macrosInSelect": true,
                "selectItems": [],
                "simpleValueType": true,
                "enablingConditions": [
                  {
                    "paramName": "orderStatusCustomDeduplicationCheck",
                    "paramValue": true,
                    "type": "EQUALS"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "tagOther",
        "checkboxText": "Other type of page view",
        "simpleValueType": true
      },
      {
        "type": "LABEL",
        "name": "labelOther",
        "displayName": "Other"
      },
      {
        "type": "CHECKBOX",
        "name": "tagNewProducts",
        "checkboxText": "New products page view",
        "simpleValueType": true,
        "help": "The code should be added to pages displaying new products."
      },
      {
        "type": "CHECKBOX",
        "name": "tagSales",
        "checkboxText": "Sale or promotion page view",
        "simpleValueType": true,
        "help": "This code should be added to sales or promotions page"
      },
      {
        "type": "CHECKBOX",
        "name": "tagSize",
        "checkboxText": "Product size selection event",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "productSize",
            "displayName": "Variable containing the size of the currently viewed product.",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagSize",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains string that describes product size or (e.g., S, XXL, medium, 38, 44)"
          }
        ],
        "help": "The code should be executed when a user selects a product size. The code should not be triggered with a default value."
      },
      {
        "type": "CHECKBOX",
        "name": "tagUid",
        "checkboxText": "User ID (Cross-device)",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "uid",
            "displayName": "Variable containing the current user identifier",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagUid",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains string with an anonymized ID of the user"
          }
        ],
        "help": "The code should be added when you want to pass an unique ID of the user - for example for cross-device targeting possibilities."
      },
      {
        "type": "CHECKBOX",
        "name": "tagAid",
        "checkboxText": "Anonymous user ID",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "aid",
            "displayName": "Variable containing the current anonymous user identifier",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagAid",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains string with an anonymized ID of the user"
          }
        ],
        "help": "The code should be added when you want to pass an unique anonymous ID of the user"
      },
      {
        "type": "CHECKBOX",
        "name": "tagSid",
        "checkboxText": "Session ID",
        "simpleValueType": true,
        "subParams": [
          {
            "type": "SELECT",
            "name": "sid",
            "displayName": "Variable containing the current user session identifier",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "tagSid",
                "paramValue": true,
                "type": "EQUALS"
              }
            ],
            "help": "Select variable that contains string with a session ID of the user"
          }
        ],
        "help": "The code should be added when you want to pass an unique session ID of the user"
      },
      {
        "type": "CHECKBOX",
        "name": "tagOfflineCheck",
        "checkboxText": "Offline store check event",
        "simpleValueType": true,
        "help": "This code should be executed every time a user checks product availability in an offline store."
      },
      {
        "type": "CHECKBOX",
        "name": "tagCustom",
        "checkboxText": "Custom Tags",
        "simpleValueType": true
      }
    ],
    "enablingConditions": [
      {
        "paramName": "advTaggingHash",
        "paramValue": "",
        "type": "PRESENT"
      }
    ],
    "help": "Select tags and their values"
  },
  {
    "type": "PARAM_TABLE",
    "name": "customTagsTable",
    "displayName": "Custom Tags",
    "paramTableColumns": [
      {
        "param": {
          "type": "TEXT",
          "name": "customTagName",
          "displayName": "Custom Tag Name",
          "simpleValueType": true,
          "help": "The value should be consulted with RTB House Customer Service Manager.",
          "valueValidators": [
            {
              "type": "NON_EMPTY"
            },
            {
              "type": "REGEX",
              "args": [
                "^[a-zA-Z0-9\\-]+$"
              ]
            }
          ],
          "valueHint": "Words, number and \u0027-\u0027 accepted"
        },
        "isUnique": true
      },
      {
        "param": {
          "type": "TEXT",
          "name": "customTagValue",
          "displayName": "Custom Tag Value",
          "simpleValueType": true,
          "help": "The value should be consulted with RTB House Customer Service Manager."
        },
        "isUnique": false
      }
    ],
    "enablingConditions": [
      {
        "paramName": "tagCustom",
        "paramValue": true,
        "type": "EQUALS"
      }
    ],
    "newRowButtonText": "Add"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

var injectHiddenIframe = require('injectHiddenIframe');
var encodeUriComponent = require('encodeUriComponent');
var makeString = require('makeString');
var localStorage = require('localStorage');
var Math = require('Math');
var getReferrerUrl = require('getReferrerUrl');
var getUrl = require('getUrl');
var getTimestampMillis = require('getTimestampMillis');
var generateRandom = require('generateRandom');

var tagsRaw = [];
for (var key in data) {
    if (key.indexOf('tag') !== -1 && data[key]) {
        tagsRaw.push(key);
    }
}

var localStorageKey = '__rtbhouse.lid';
var lid = localStorage.getItem(localStorageKey);
if (!lid || lid.length !== 20) {
  lid = '';
  var pool = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  for (var i = 0; i < 20; i++) {
    lid += pool.charAt(generateRandom(0, pool.length - 1));
  }
  localStorage.setItem(localStorageKey, lid);
}

var siteReferrer = getReferrerUrl() ? encodeUriComponent(getReferrerUrl()) : '';
var siteUrl = getUrl() ? encodeUriComponent(getUrl()) : '';
var timestamp = makeString(getTimestampMillis());

var taggingHash = makeString(data.advTaggingHash);
var region = makeString(data.advRegion);
var pageType = makeString(data.pageType);

var tags = [];
var tagValue = '&id=pr_' + taggingHash;

tagsRaw.forEach( (tag) => {

  var code = '';

  switch(tag) {

    case 'tagOther':
      code = tagValue + (tagsRaw.length === 1 ? '&ncm=1' : '');

      break;

    case 'tagHome':
      code = tagValue + '_home';

      break;

    case 'tagOffer':
      var offerId = data.offerOfferId ? makeString(data.offerOfferId) : '';
      code = tagValue + '_offer_' + offerId;

      break;

    case 'tagListing':
      var listingOfferIds = data.listingOfferIds ? makeString(data.listingOfferIds) : '';
      code = tagValue + '_listing_' + listingOfferIds;

      break;

    case 'tagCategory':
      var category = data.category ? makeString(data.category) : '';
      code = tagValue + '_category2_' + category;

      break;

    case 'tagBasketAdd':
      var basketAddOfferId = data.basketAddOfferId ? makeString(data.basketAddOfferId) : '';
      code = tagValue + '_basketadd_' + basketAddOfferId;

      break;

    case 'tagBasketStatus':
      var basketStatusOfferIds = data.basketStatusOfferIds ? makeString(data.basketStatusOfferIds) : '';
      code = tagValue + '_basketstatus_' + basketStatusOfferIds;

      break;

    case 'tagStartOrder':
      code = tagValue + '_startorder';

      break;

    case 'tagOrderClick':
      var orderClickValue = data.orderClickValue ? makeString(data.orderClickValue).replace(',', '.') : '';
      var orderClickOrderId = data.orderClickOrderId ? makeString(data.orderClickOrderId).split('_').join('-') : '';
      var orderClickOfferId = data.orderClickOfferId ? makeString(data.orderClickOfferId) : '';
      code = tagValue + '_orderclick3_' + orderClickValue + '_' + orderClickOrderId + '_' + orderClickOfferId;

      break;

    case 'tagOrderStatus':
      var orderStatusValue = data.orderStatusValue ? makeString(data.orderStatusValue).replace(',', '.') : '';
      var orderStatusOrderId = data.orderStatusOrderId ? makeString(data.orderStatusOrderId).split('_').join('-') : '';
      var orderStatusOfferIds = data.orderStatusOfferIds ? makeString(data.orderStatusOfferIds) : '';
      var cdEnabled = data.orderStatusCustomDeduplicationCheck;
      var rawCd = data.orderStatusCustomDeduplication;
      var cdIfEnabled = rawCd === 'false' || rawCd === false ? 'false' : 'true';
      var cd = !cdEnabled ? 'default' : cdIfEnabled;
      code = tagValue + '_orderstatus2_' + orderStatusValue + '_' + orderStatusOrderId + '_' + orderStatusOfferIds + '&cd=' + cd;

      break;

    case 'tagUid':
      var uid = data.uid ? makeString(data.uid) : '';
      code = tagValue + '_uid_' + uid;

      break;

    case 'tagAid':
      var aid = data.aid ? makeString(data.aid) : '';
      code = tagValue + '_aid_' + aid;

      break;

    case 'tagSid':
      var sid = data.sid ? makeString(data.sid) : '';
      code = tagValue + '_sid_' + sid;

      break;

    case 'tagSize':
      var productSize = data.productSize ? makeString(data.productSize) : '';
      code = tagValue + '_size_' + productSize;

      break;

    case 'tagOfflineCheck':
      code = tagValue + '_offlinecheck';

      break;

    case 'tagNewProducts':
      code = tagValue + '_newoffers';

      break;

    case 'tagSales':
      code = tagValue + '_sales';

      break;

    case 'tagWishlist':
      var wishlistOfferId = data.wishlistOfferId ? makeString(data.wishlistOfferId) : '';
      code = tagValue + '_wishlist_' + wishlistOfferId;

      break;

    case 'tagCustom':
      var customTagsTable = data.customTagsTable;
      customTagsTable.forEach( (customTag) => {

          var customTagName = makeString(customTag.customTagName).split('_').join('-');
          var customTagValue = makeString(customTag.customTagValue);
          code += tagValue + '_custom_' + customTagName + '_' + customTagValue;

      });

      break;

  }

  tags.push(code);

});

var source =
    'https://' +
    region +
    '.creativecdn.com/tags?type=iframe' +
    tags.join('') +
    tagValue +
    '_lid_' +
    encodeUriComponent(lid) +
    '&su=' +
    siteUrl +
    '&sr=' +
    siteReferrer +
    '&ts=' +
    encodeUriComponent(timestamp);

injectHiddenIframe(source, data.gtmOnSuccess);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_hidden_iframe",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://*.creativecdn.com/tags*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_local_storage",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "__rtbhouse.lid"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 8/20/2019, 3:32:36 PM

